<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Examples &mdash; ElasticCode 0.0.1 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/override.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/favicon2.ico"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="UI" href="../../ui/index.html" />
    <link rel="prev" title="CLI" href="../index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #abbcc3" >
            <a href="../../index.html">
            <img src="../../_static/flow.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../overview/index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../designgoals/index.html">Goals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usecases/index.html">Use Cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install/index.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart/index.html">Quickstart</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Data Flows</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../dataflows/index.html">Data Flows</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Technology</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../architecture/index.html">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../database/index.html">Database</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../servers/index.html">Servers</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">CLI</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#flow">flow</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#database">Database</a></li>
<li class="toctree-l3"><a class="reference internal" href="#objects">Objects</a></li>
<li class="toctree-l3"><a class="reference internal" href="#queues">Queues</a></li>
<li class="toctree-l3"><a class="reference internal" href="#processors">Processors</a></li>
<li class="toctree-l3"><a class="reference internal" href="#calls">Calls</a></li>
<li class="toctree-l3"><a class="reference internal" href="#listening">Listening</a></li>
<li class="toctree-l3"><a class="reference internal" href="#running-an-agent">Running an Agent</a></li>
<li class="toctree-l3"><a class="reference internal" href="#roles-users">Roles &amp; Users</a></li>
<li class="toctree-l3"><a class="reference internal" href="#privileges-rights">Privileges &amp; Rights</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../ui/index.html">UI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../stack/index.html">Stack</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Learning</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">Tutorials</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Support</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../discord/index.html">Discord</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #abbcc3" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">ElasticCode</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">CLI</a> &raquo;</li>
      <li>Examples</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/CLI/examples/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="examples">
<h1>Examples<a class="headerlink" href="#examples" title="Permalink to this headline"></a></h1>
<div class="toctree-wrapper compound">
</div>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">The ‘flow’ command is the single command for building and managing a ElasticCode network.</span><a class="headerlink" href="#id1" title="Permalink to this code"></a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ flow
Usage: flow <span class="o">[</span>OPTIONS<span class="o">]</span> COMMAND <span class="o">[</span>ARGS<span class="o">]</span>...

  CLI <span class="k">for</span> creating <span class="p">&amp;</span> managing flow networks

Options:
  --debug              Debug switch
  -d, --db TEXT        Database URI
  --backend TEXT       Task queue backend
  --broker TEXT        Message broker URI
  -a, --api TEXT       Message broker API URI
  -u, --user TEXT      Message broker API user
  -p, --password TEXT  Message broker API password
  -i, --ini TEXT       flow .ini configuration file
  -c, --config         Configure pyfi
  --help               Show this message and exit.

Commands:
  add        Add an object to the database
  agent      Commands <span class="k">for</span> remote agent management
  api        API server admin
  compose    Manage declarative infrastructure files
  db         Database operations
  delete     Delete an object from the database
  listen     Listen to a processor output
  login      Log into flow CLI
  <span class="nb">logout</span>     Logout current user
  ls         List database objects and their relations
  network    Network operations
  node       Node management operations
  proc       Run or manage processors
  scheduler  Scheduler management commands
  task       Pyfi task management
  update     Update a database object
  user       User commands
  web        Web server admin
  whoami     Database login user
  worker     Run pyfi worker
</pre></div>
</div>
</div>
<section id="database">
<h2>Database<a class="headerlink" href="#database" title="Permalink to this headline"></a></h2>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">Flow database sub-commands</span><a class="headerlink" href="#id2" title="Permalink to this code"></a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ flow db
Usage: flow db <span class="o">[</span>OPTIONS<span class="o">]</span> COMMAND <span class="o">[</span>ARGS<span class="o">]</span>...

  Database operations

Options:
  --help  Show this message and exit.

Commands:
  drop     Drop all database tables
  init     Initialize database tables
  json     Dump the database to JSON
  migrate  Perform database migration/upgrade
  rebuild  Drop and rebuild database tables
</pre></div>
</div>
</div>
</section>
<section id="objects">
<h2>Objects<a class="headerlink" href="#objects" title="Permalink to this headline"></a></h2>
<p>There are numerous objects within an ElasticCode network. Some are infrastructure related, others are service related. Using the ElasticCode CLI you create, update and manage these objects in the database, which acts as a <strong>single source of truth</strong> for the entire ElasticCode network.
All the deployed ElasticCode services (e.g. agents) <em>react</em> to changes in the ElasticCode database. So you could say that ElasticCode is <em>reactive</em> on a distributed, network-scale.</p>
<p>Some of the system objects and CLI commands are shown below.</p>
</section>
<section id="queues">
<h2>Queues<a class="headerlink" href="#queues" title="Permalink to this headline"></a></h2>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">Add a queue to the database</span><a class="headerlink" href="#id3" title="Permalink to this code"></a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ flow add queue --help
Usage: flow add queue <span class="o">[</span>OPTIONS<span class="o">]</span>

  Add queue object to the database

Options:
  -n, --name TEXT                 <span class="o">[</span>required<span class="o">]</span>
  -t, --type <span class="o">[</span>topic<span class="p">|</span>direct<span class="p">|</span>fanout<span class="o">]</span>
                                  <span class="o">[</span>default: direct<span class="p">;</span> required<span class="o">]</span>
  --help                          Show this message and exit.
</pre></div>
</div>
</div>
</section>
<section id="processors">
<h2>Processors<a class="headerlink" href="#processors" title="Permalink to this headline"></a></h2>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">Add a processor to the database</span><a class="headerlink" href="#id4" title="Permalink to this code"></a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ flow add processor --help
Usage: flow add processor <span class="o">[</span>OPTIONS<span class="o">]</span>

  Add processor to the database

Options:
  -n, --name TEXT               Name of this processor  <span class="o">[</span>required<span class="o">]</span>
  -m, --module TEXT             Python module <span class="o">(</span>e.g. some.module.path
                                <span class="o">[</span>required<span class="o">]</span>
  -h, --hostname TEXT           Target server hostname
  -w, --workers INTEGER         Number of worker tasks
  -r, --retries INTEGER         Number of retries to invoke this processor
  -g, --gitrepo TEXT            Git repo URI  <span class="o">[</span>required<span class="o">]</span>
  -c, --commit TEXT             Git commit id <span class="k">for</span> processor code
  -rs, --requested_status TEXT  The requested status <span class="k">for</span> this processor
  -b, --beat                    Enable the beat scheduler
  -br, --branch TEXT            Git branch to be used <span class="k">for</span> checkouts
  -p, --password TEXT           Password to access this processor
  -rq, --requirements TEXT      requirements.txt file
  -e, --endpoint TEXT           API endpoint path
  -a, --api BOOLEAN             Has an API endpoint
  -cs, --cpus INTEGER           Number of CPUs <span class="k">for</span> default deployment
  -d, --deploy                  Enable the beat scheduler
  -mp, --modulepath TEXT        Relative repo path to python module file
  --help                        Show this message and exit.
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text">Specific processor subcommands</span><a class="headerlink" href="#id5" title="Permalink to this code"></a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ flow proc
Usage: flow proc <span class="o">[</span>OPTIONS<span class="o">]</span> COMMAND <span class="o">[</span>ARGS<span class="o">]</span>...

  Run or manage processors

Options:
  --id TEXT  ID of processor
  --help     Show this message and exit.

Commands:
  pause    Pause a processor
  remove   Remove a processor
  restart  Start a processor
  resume   Pause a processor
  start    Start a processor
  stop     Stop a processor
</pre></div>
</div>
</div>
</section>
<section id="calls">
<h2>Calls<a class="headerlink" href="#calls" title="Permalink to this headline"></a></h2>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text">Call subcommands</span><a class="headerlink" href="#id6" title="Permalink to this code"></a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ flow ls calls --help
Usage: flow ls calls <span class="o">[</span>OPTIONS<span class="o">]</span>

  List calls

Options:
  -p, --page INTEGER
  -r, --rows INTEGER
  -u, --unfinished
  -a, --ascend
  -i, --id
  -t, --tracking
  -tk, --task
  --help              Show this message and exit.
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id7">
<div class="code-block-caption"><span class="caption-text">flow ls calls</span><a class="headerlink" href="#id7" title="Permalink to this code"></a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ flow ls calls
+------+-----+-------------------------------------+--------------------------------------+----------+----------------------------+-------------------------------------+----------------------------+----------------------------+----------+
<span class="p">|</span> Page <span class="p">|</span> Row <span class="p">|</span>                 Name                <span class="p">|</span>                  ID                  <span class="p">|</span>  Owner   <span class="p">|</span>        Last Updated        <span class="p">|</span>                Socket               <span class="p">|</span>          Started           <span class="p">|</span>          Finished          <span class="p">|</span>  State   <span class="p">|</span>
+------+-----+-------------------------------------+--------------------------------------+----------+----------------------------+-------------------------------------+----------------------------+----------------------------+----------+
<span class="p">|</span>  <span class="m">1</span>   <span class="p">|</span>  <span class="m">1</span>  <span class="p">|</span>    pyfi.processors.sample.do_this   <span class="p">|</span> e3f73300-f3fd-4230-ba11-258d4f5a17f4 <span class="p">|</span> postgres <span class="p">|</span> <span class="m">2021</span>-09-13 <span class="m">19</span>:30:19.933346 <span class="p">|</span>    pyfi.processors.sample.do_this   <span class="p">|</span> <span class="m">2021</span>-09-13 <span class="m">19</span>:30:19.903573 <span class="p">|</span> <span class="m">2021</span>-09-13 <span class="m">19</span>:30:19.932491 <span class="p">|</span> finished <span class="p">|</span>
<span class="p">|</span>  <span class="m">1</span>   <span class="p">|</span>  <span class="m">2</span>  <span class="p">|</span> pyfi.processors.sample.do_something <span class="p">|</span> e3bf09c5-ae45-4772-b301-c394acae3c4e <span class="p">|</span> postgres <span class="p">|</span> <span class="m">2021</span>-09-13 <span class="m">19</span>:30:19.885993 <span class="p">|</span> pyfi.processors.sample.do_something <span class="p">|</span> <span class="m">2021</span>-09-13 <span class="m">19</span>:30:19.847282 <span class="p">|</span> <span class="m">2021</span>-09-13 <span class="m">19</span>:30:19.885440 <span class="p">|</span> finished <span class="p">|</span>
<span class="p">|</span>  <span class="m">1</span>   <span class="p">|</span>  <span class="m">3</span>  <span class="p">|</span>    pyfi.processors.sample.do_this   <span class="p">|</span> a58de16a-1b92-4acb-81c1-92e81cb6ea56 <span class="p">|</span> postgres <span class="p">|</span> <span class="m">2021</span>-09-13 <span class="m">19</span>:29:49.944219 <span class="p">|</span>    pyfi.processors.sample.do_this   <span class="p">|</span> <span class="m">2021</span>-09-13 <span class="m">19</span>:29:49.917225 <span class="p">|</span> <span class="m">2021</span>-09-13 <span class="m">19</span>:29:49.943415 <span class="p">|</span> finished <span class="p">|</span>
<span class="p">|</span>  <span class="m">1</span>   <span class="p">|</span>  <span class="m">4</span>  <span class="p">|</span> pyfi.processors.sample.do_something <span class="p">|</span> 58df162a-ac2e-40b7-9e27-635c61a4d9a7 <span class="p">|</span> postgres <span class="p">|</span> <span class="m">2021</span>-09-13 <span class="m">19</span>:29:49.868975 <span class="p">|</span> pyfi.processors.sample.do_something <span class="p">|</span> <span class="m">2021</span>-09-13 <span class="m">19</span>:29:49.820097 <span class="p">|</span> <span class="m">2021</span>-09-13 <span class="m">19</span>:29:49.868109 <span class="p">|</span> finished <span class="p">|</span>
<span class="p">|</span>  <span class="m">1</span>   <span class="p">|</span>  <span class="m">5</span>  <span class="p">|</span>    pyfi.processors.sample.do_this   <span class="p">|</span> 60d8b91d-1b8b-433c-a289-5704856d37d1 <span class="p">|</span> postgres <span class="p">|</span> <span class="m">2021</span>-09-13 <span class="m">19</span>:29:19.907705 <span class="p">|</span>    pyfi.processors.sample.do_this   <span class="p">|</span> <span class="m">2021</span>-09-13 <span class="m">19</span>:29:19.880742 <span class="p">|</span> <span class="m">2021</span>-09-13 <span class="m">19</span>:29:19.906931 <span class="p">|</span> finished <span class="p">|</span>
<span class="p">|</span>  <span class="m">1</span>   <span class="p">|</span>  <span class="m">6</span>  <span class="p">|</span> pyfi.processors.sample.do_something <span class="p">|</span> 66c78849-9052-48d0-ae62-59942d544096 <span class="p">|</span> postgres <span class="p">|</span> <span class="m">2021</span>-09-13 <span class="m">19</span>:29:19.861880 <span class="p">|</span> pyfi.processors.sample.do_something <span class="p">|</span> <span class="m">2021</span>-09-13 <span class="m">19</span>:29:19.824456 <span class="p">|</span> <span class="m">2021</span>-09-13 <span class="m">19</span>:29:19.861330 <span class="p">|</span> finished <span class="p">|</span>
<span class="p">|</span>  <span class="m">1</span>   <span class="p">|</span>  <span class="m">7</span>  <span class="p">|</span>    pyfi.processors.sample.do_this   <span class="p">|</span> e5189a71-9805-492e-a8d7-e5eb2b8d68d3 <span class="p">|</span> postgres <span class="p">|</span> <span class="m">2021</span>-09-13 <span class="m">19</span>:28:49.873301 <span class="p">|</span>    pyfi.processors.sample.do_this   <span class="p">|</span> <span class="m">2021</span>-09-13 <span class="m">19</span>:28:49.842724 <span class="p">|</span> <span class="m">2021</span>-09-13 <span class="m">19</span>:28:49.872176 <span class="p">|</span> finished <span class="p">|</span>
<span class="p">|</span>  <span class="m">1</span>   <span class="p">|</span>  <span class="m">8</span>  <span class="p">|</span> pyfi.processors.sample.do_something <span class="p">|</span> 35fd3635-743a-4015-acfe-c5a8f62ef65d <span class="p">|</span> postgres <span class="p">|</span> <span class="m">2021</span>-09-13 <span class="m">19</span>:28:49.812921 <span class="p">|</span> pyfi.processors.sample.do_something <span class="p">|</span> <span class="m">2021</span>-09-13 <span class="m">19</span>:28:49.789503 <span class="p">|</span> <span class="m">2021</span>-09-13 <span class="m">19</span>:28:49.812406 <span class="p">|</span> finished <span class="p">|</span>
<span class="p">|</span>  <span class="m">1</span>   <span class="p">|</span>  <span class="m">9</span>  <span class="p">|</span>    pyfi.processors.sample.do_this   <span class="p">|</span> 4136ebe2-ee96-4b74-ba0e-33d8c5974252 <span class="p">|</span> postgres <span class="p">|</span> <span class="m">2021</span>-09-13 <span class="m">19</span>:28:19.830508 <span class="p">|</span>    pyfi.processors.sample.do_this   <span class="p">|</span> <span class="m">2021</span>-09-13 <span class="m">19</span>:28:19.805839 <span class="p">|</span> <span class="m">2021</span>-09-13 <span class="m">19</span>:28:19.829667 <span class="p">|</span> finished <span class="p">|</span>
<span class="p">|</span>  <span class="m">1</span>   <span class="p">|</span>  <span class="m">10</span> <span class="p">|</span> pyfi.processors.sample.do_something <span class="p">|</span> 707f18c5-5708-4c70-81fb-ca0afb30e28b <span class="p">|</span> postgres <span class="p">|</span> <span class="m">2021</span>-09-13 <span class="m">19</span>:28:19.789542 <span class="p">|</span> pyfi.processors.sample.do_something <span class="p">|</span> <span class="m">2021</span>-09-13 <span class="m">19</span>:28:19.764792 <span class="p">|</span> <span class="m">2021</span>-09-13 <span class="m">19</span>:28:19.788999 <span class="p">|</span> finished <span class="p">|</span>
+------+-----+-------------------------------------+--------------------------------------+----------+----------------------------+-------------------------------------+----------------------------+----------------------------+----------+
Page <span class="m">1</span> of <span class="m">383</span> of <span class="m">3830</span> total records
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id8">
<div class="code-block-caption"><span class="caption-text">flow ls call –help</span><a class="headerlink" href="#id8" title="Permalink to this code"></a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ flow ls call --help
Usage: flow ls call <span class="o">[</span>OPTIONS<span class="o">]</span>

List details about a call record

Options:
--id TEXT        ID of call
-n, --name TEXT  Name of call
-r, --result     Include result of call
-t, --tree       Show forward call tree
-g, --graph      Show <span class="nb">complete</span> call graph
-f, --flow       Show all calls <span class="k">in</span> a workflow
--help           Show this message and exit.
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id9">
<div class="code-block-caption"><span class="caption-text">flow ls call –id e3bf09c5-ae45-4772-b301-c394acae3c4e</span><a class="headerlink" href="#id9" title="Permalink to this code"></a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ flow ls call --id e3bf09c5-ae45-4772-b301-c394acae3c4e
+-------------------------------------+--------------------------------------+----------+----------------------------+-------------------------------------+----------------------------+----------------------------+----------+
<span class="p">|</span>                 Name                <span class="p">|</span>                  ID                  <span class="p">|</span>  Owner   <span class="p">|</span>        Last Updated        <span class="p">|</span>                Socket               <span class="p">|</span>          Started           <span class="p">|</span>          Finished          <span class="p">|</span>  State   <span class="p">|</span>
+-------------------------------------+--------------------------------------+----------+----------------------------+-------------------------------------+----------------------------+----------------------------+----------+
<span class="p">|</span> pyfi.processors.sample.do_something <span class="p">|</span> e3bf09c5-ae45-4772-b301-c394acae3c4e <span class="p">|</span> postgres <span class="p">|</span> <span class="m">2021</span>-09-13 <span class="m">19</span>:30:19.885993 <span class="p">|</span> pyfi.processors.sample.do_something <span class="p">|</span> <span class="m">2021</span>-09-13 <span class="m">19</span>:30:19.847282 <span class="p">|</span> <span class="m">2021</span>-09-13 <span class="m">19</span>:30:19.885440 <span class="p">|</span> finished <span class="p">|</span>
+-------------------------------------+--------------------------------------+----------+----------------------------+-------------------------------------+----------------------------+----------------------------+----------+
Provenance
+--------------------------------------+-------------+-------------+
<span class="p">|</span>                 Task                 <span class="p">|</span> Task Parent <span class="p">|</span> Flow Parent <span class="p">|</span>
+--------------------------------------+-------------+-------------+
<span class="p">|</span> a13ba1e7-78f9-4644-9c29-696dfd89e9e4 <span class="p">|</span>     None    <span class="p">|</span>     None    <span class="p">|</span>
+--------------------------------------+-------------+-------------+
Events
+----------+--------------------------------------+----------+----------------------------+-----------------------------------------------------+
<span class="p">|</span>   Name   <span class="p">|</span>                  ID                  <span class="p">|</span>  Owner   <span class="p">|</span>        Last Updated        <span class="p">|</span>                         Note                        <span class="p">|</span>
+----------+--------------------------------------+----------+----------------------------+-----------------------------------------------------+
<span class="p">|</span> received <span class="p">|</span> 8e8845d5-cd32-40d9-93c7-e95f7500926c <span class="p">|</span> postgres <span class="p">|</span> <span class="m">2021</span>-09-13 <span class="m">19</span>:30:19.844512 <span class="p">|</span>  Received task pyfi.processors.sample.do_something  <span class="p">|</span>
<span class="p">|</span>  prerun  <span class="p">|</span> a2507cd1-1d72-4ad1-be74-375aac29f1c4 <span class="p">|</span> postgres <span class="p">|</span> <span class="m">2021</span>-09-13 <span class="m">19</span>:30:19.874789 <span class="p">|</span> Prerun <span class="k">for</span> task pyfi.processors.sample.do_something <span class="p">|</span>
<span class="p">|</span> postrun  <span class="p">|</span> f8b5ff03-e0e3-467d-9257-a682f0865581 <span class="p">|</span> postgres <span class="p">|</span> <span class="m">2021</span>-09-13 <span class="m">19</span>:30:19.886504 <span class="p">|</span>                  Postrun <span class="k">for</span> task                   <span class="p">|</span>
+----------+--------------------------------------+----------+----------------------------+-----------------------------------------------------+
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id10">
<div class="code-block-caption"><span class="caption-text">flow ls call –id e3bf09c5-ae45-4772-b301-c394acae3c4e –tree</span><a class="headerlink" href="#id10" title="Permalink to this code"></a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ flow ls call --id e3bf09c5-ae45-4772-b301-c394acae3c4e --tree
pyfi.processors.sample.do_something
      └────────────────────┐
               pyfi.processors.sample.do_this
</pre></div>
</div>
</div>
</section>
<section id="listening">
<h2>Listening<a class="headerlink" href="#listening" title="Permalink to this headline"></a></h2>
<p>The listen command allows you to listen to the pubsub channels associated with queues and processors. A kind of <em>network sniffer</em> that displays in real-time the various message traffic, compute results, lifecycle events etc.
You can provide your own custom class to receive the results which is designed to provide a simple and loosely coupled mechanism for system integrations.</p>
<div class="literal-block-wrapper docutils container" id="id11">
<div class="code-block-caption"><span class="caption-text">Messages will be displayed as they are generated within the network.</span><a class="headerlink" href="#id11" title="Permalink to this code"></a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ flow listen --help
Usage: flow listen <span class="o">[</span>OPTIONS<span class="o">]</span>

Listen to a processor output

Options:
-n, --name TEXT     Name of processor  <span class="o">[</span>required<span class="o">]</span>
-c, --channel TEXT  Listen channel <span class="o">(</span>e.g. task, log, etc<span class="o">)</span>  <span class="o">[</span>required<span class="o">]</span>
-a, --adaptor TEXT  Adaptor class <span class="k">function</span> <span class="o">(</span>e.g. my.module.class.function<span class="o">)</span>
--help              Show this message and exit.
$ flow listen --name pyfi.queue1.proc1 --channel task
Listening to pyfi.queue1.proc1
<span class="o">{</span><span class="s1">&#39;type&#39;</span>: <span class="s1">&#39;psubscribe&#39;</span>, <span class="s1">&#39;pattern&#39;</span>: None, <span class="s1">&#39;channel&#39;</span>: b<span class="s1">&#39;pyfi.queue1.proc1.task&#39;</span>, <span class="s1">&#39;data&#39;</span>: <span class="m">1</span><span class="o">}</span>
<span class="o">{</span><span class="s1">&#39;type&#39;</span>: <span class="s1">&#39;pmessage&#39;</span>, <span class="s1">&#39;pattern&#39;</span>: b<span class="s1">&#39;pyfi.queue1.proc1.task&#39;</span>, <span class="s1">&#39;channel&#39;</span>: b<span class="s1">&#39;pyfi.queue1.proc1.task&#39;</span>, <span class="s1">&#39;data&#39;</span>: b<span class="s1">&#39;{&quot;channel&quot;: &quot;task&quot;, &quot;state&quot;: &quot;received&quot;, &quot;date&quot;: &quot;2021-09-13 19:37:20.094443&quot;, &quot;room&quot;: &quot;pyfi.queue1.proc1&quot;}&#39;</span><span class="o">}</span>
<span class="o">{</span><span class="s1">&#39;type&#39;</span>: <span class="s1">&#39;pmessage&#39;</span>, <span class="s1">&#39;pattern&#39;</span>: b<span class="s1">&#39;pyfi.queue1.proc1.task&#39;</span>, <span class="s1">&#39;channel&#39;</span>: b<span class="s1">&#39;pyfi.queue1.proc1.task&#39;</span>, <span class="s1">&#39;data&#39;</span>: b<span class="s1">&#39;{&quot;channel&quot;: &quot;task&quot;, &quot;state&quot;: &quot;running&quot;, &quot;date&quot;: &quot;2021-09-13 19:37:20.108668&quot;, &quot;room&quot;: &quot;pyfi.queue1.proc1&quot;}&#39;</span><span class="o">}</span>
<span class="o">{</span><span class="s1">&#39;type&#39;</span>: <span class="s1">&#39;pmessage&#39;</span>, <span class="s1">&#39;pattern&#39;</span>: b<span class="s1">&#39;pyfi.queue1.proc1.task&#39;</span>, <span class="s1">&#39;channel&#39;</span>: b<span class="s1">&#39;pyfi.queue1.proc1.task&#39;</span>, <span class="s1">&#39;data&#39;</span>: b<span class="s1">&#39;{&quot;module&quot;: &quot;pyfi.processors.sample&quot;, &quot;date&quot;: &quot;2021-09-13 19:37:20.133327&quot;, &quot;resultkey&quot;: &quot;celery-task-meta-b3feb181-484d-4b98-aba8-daabd07ee3d1&quot;, &quot;message&quot;: &quot;{\\&quot;module\\&quot;: \\&quot;pyfi.processors.sample\\&quot;, \\&quot;date\\&quot;: \\&quot;2021-09-13 19:37:20.133327\\&quot;, \\&quot;resultkey\\&quot;: \\&quot;celery-task-meta-b3feb181-484d-4b98-aba8-daabd07ee3d1\\&quot;, \\&quot;message\\&quot;: \\&quot;\\\\\\&quot;\\\\\\\\\\\\\\&quot;Message:Hello World!\\\\\\\\\\\\\\&quot;\\\\\\&quot;\\&quot;, \\&quot;channel\\&quot;: \\&quot;task\\&quot;, \\&quot;room\\&quot;: \\&quot;pyfi.queue1.proc1\\&quot;, \\&quot;task\\&quot;: \\&quot;do_something\\&quot;}&quot;, &quot;channel&quot;: &quot;task&quot;, &quot;room&quot;: &quot;pyfi.queue1.proc1&quot;, &quot;task&quot;: &quot;do_something&quot;, &quot;state&quot;: &quot;postrun&quot;}&#39;</span><span class="o">}</span>
</pre></div>
</div>
</div>
</section>
<section id="running-an-agent">
<h2>Running an Agent<a class="headerlink" href="#running-an-agent" title="Permalink to this headline"></a></h2>
<div class="literal-block-wrapper docutils container" id="id12">
<div class="code-block-caption"><span class="caption-text">FLOW agent subcommand</span><a class="headerlink" href="#id12" title="Permalink to this code"></a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ flow agent
Usage: flow agent <span class="o">[</span>OPTIONS<span class="o">]</span> COMMAND <span class="o">[</span>ARGS<span class="o">]</span>...

Run flow agent

Options:
--help  Show this message and exit.

Commands:
start  Run pyfi agent server
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id13">
<div class="code-block-caption"><span class="caption-text">Flow agent subcommand</span><a class="headerlink" href="#id13" title="Permalink to this code"></a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ flow agent start --help
Usage: flow agent start <span class="o">[</span>OPTIONS<span class="o">]</span>

  Start an agent

Options:
  -p, --port INTEGER         Healthcheck port
  --clean                    Remove work directories before launch
  -b, --backend TEXT         Message backend URI
  -r, --broker TEXT          Message broker URI
  -n, --name TEXT            Hostname <span class="k">for</span> this agent to use
  -c, --config TEXT          Config module.object import <span class="o">(</span>e.g.
                             path.to.module.MyConfigClass
  -q, --queues               Run the queue monitor only
  -u, --user TEXT            Run the worker as user
  -po, --pool INTEGER        Process pool <span class="k">for</span> message dispatches
  -cp, --cpus INTEGER        Number of CPUs
  -s, --size INTEGER         Maximum number of messages on worker internal
                             queue
  -h, --host TEXT            Remote hostname to start the agent via ssh
  -wp, --workerport INTEGER  Healthcheck port <span class="k">for</span> worker
  --help                     Show this message and exit.
</pre></div>
</div>
</div>
</section>
<section id="roles-users">
<h2>Roles &amp; Users<a class="headerlink" href="#roles-users" title="Permalink to this headline"></a></h2>
<div class="literal-block-wrapper docutils container" id="id14">
<div class="code-block-caption"><span class="caption-text">FLOW user, role and privilege subcommands</span><a class="headerlink" href="#id14" title="Permalink to this code"></a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ flow add user --help
Usage: flow add user <span class="o">[</span>OPTIONS<span class="o">]</span>

Add user object to the database

Options:
-n, --name TEXT      <span class="o">[</span>required<span class="o">]</span>
-e, --email TEXT     <span class="o">[</span>required<span class="o">]</span>
-p, --password TEXT  <span class="o">[</span>required<span class="o">]</span>
--help               Show this message and exit.

$ flow add role --help
Usage: flow add role <span class="o">[</span>OPTIONS<span class="o">]</span>

Add role object to the database

Options:
-n, --name TEXT  <span class="o">[</span>required<span class="o">]</span>
--help           Show this message and exit.

$ flow add privilege --help
Usage: flow add privilege <span class="o">[</span>OPTIONS<span class="o">]</span>

Add privilege to the database

Options:
-u, --user TEXT
-n, --name TEXT  <span class="o">[</span>required<span class="o">]</span>
-r, --role TEXT
--help           Show this message and exit.
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id15">
<div class="code-block-caption"><span class="caption-text">Creating a user</span><a class="headerlink" href="#id15" title="Permalink to this code"></a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ flow add user
Name: joe
Email: joe@xyz
Password: <span class="m">12345</span>
CREATE USER joe WITH PASSWORD <span class="s1">&#39;12345&#39;</span>
User <span class="s2">&quot;joe&quot;</span> added
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id16">
<div class="code-block-caption"><span class="caption-text">Creating a role</span><a class="headerlink" href="#id16" title="Permalink to this code"></a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ flow add role -n developer
bc15ee9d-a208-43a9-82d2-bf0810dc4380:developer:2021-09-15 <span class="m">21</span>:50:40.714192
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id17">
<div class="code-block-caption"><span class="caption-text">Adding a privilege to a user</span><a class="headerlink" href="#id17" title="Permalink to this code"></a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ flow add privilege -u joe -n ADD_PROCESSOR
Privilege added
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id18">
<div class="code-block-caption"><span class="caption-text">List a user with role_privileges</span><a class="headerlink" href="#id18" title="Permalink to this code"></a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ flow ls user -n joe
+------+--------------------------------------+----------+---------+
<span class="p">|</span> Name <span class="p">|</span>                  ID                  <span class="p">|</span>  Owner   <span class="p">|</span>  Email  <span class="p">|</span>
+------+--------------------------------------+----------+---------+
<span class="p">|</span> joe  <span class="p">|</span> a8dcf9bb-c821-4d44-82f5-828dceb4cb23 <span class="p">|</span> postgres <span class="p">|</span> joe@xyz <span class="p">|</span>
+------+--------------------------------------+----------+---------+
Privileges
+------+---------------+----------------------------+----------+
<span class="p">|</span> Name <span class="p">|</span>     Right     <span class="p">|</span>        Last Updated        <span class="p">|</span>    By    <span class="p">|</span>
+------+---------------+----------------------------+----------+
<span class="p">|</span> joe  <span class="p">|</span> ADD_PROCESSOR <span class="p">|</span> <span class="m">2021</span>-09-15 <span class="m">21</span>:46:48.611286 <span class="p">|</span> postgres <span class="p">|</span>
+------+---------------+----------------------------+----------+
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id19">
<div class="code-block-caption"><span class="caption-text">Adding a privilege to a role</span><a class="headerlink" href="#id19" title="Permalink to this code"></a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ flow add privilege -r developer -n ADD_PROCESSOR
Privilege added
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id20">
<div class="code-block-caption"><span class="caption-text">Adding a role to a user</span><a class="headerlink" href="#id20" title="Permalink to this code"></a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
<section id="privileges-rights">
<h2>Privileges &amp; Rights<a class="headerlink" href="#privileges-rights" title="Permalink to this headline"></a></h2>
<p>A <strong>right</strong> is an atomic string that names a particular <strong>privilege</strong>. It only becomes a privilege when it’s associated with a user.
When it’s just <strong>a name</strong> we call it a <em>right</em>.</p>
<div class="literal-block-wrapper docutils container" id="id21">
<div class="code-block-caption"><span class="caption-text">Available Rights</span><a class="headerlink" href="#id21" title="Permalink to this code"></a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">rights</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ALL&#39;</span><span class="p">,</span>
    <span class="s1">&#39;CREATE&#39;</span><span class="p">,</span>
    <span class="s1">&#39;READ&#39;</span><span class="p">,</span>
    <span class="s1">&#39;UPDATE&#39;</span><span class="p">,</span>
    <span class="s1">&#39;DELETE&#39;</span><span class="p">,</span>

    <span class="s1">&#39;DB_DROP&#39;</span><span class="p">,</span>
    <span class="s1">&#39;DB_INIT&#39;</span><span class="p">,</span>

    <span class="s1">&#39;START_AGENT&#39;</span><span class="p">,</span>

    <span class="s1">&#39;RUN_TASK&#39;</span><span class="p">,</span>
    <span class="s1">&#39;CANCEL_TASK&#39;</span><span class="p">,</span>

    <span class="s1">&#39;START_PROCESSOR&#39;</span><span class="p">,</span>
    <span class="s1">&#39;STOP_PROCESSOR&#39;</span><span class="p">,</span>
    <span class="s1">&#39;PAUSE_PROCESSOR&#39;</span><span class="p">,</span>
    <span class="s1">&#39;RESUME_PROCESSOR&#39;</span><span class="p">,</span>
    <span class="s1">&#39;LOCK_PROCESSOR&#39;</span><span class="p">,</span>
    <span class="s1">&#39;UNLOCK_PROCESSOR&#39;</span><span class="p">,</span>
    <span class="s1">&#39;VIEW_PROCESSOR&#39;</span><span class="p">,</span>
    <span class="s1">&#39;VIEW_PROCESSOR_CONFIG&#39;</span><span class="p">,</span>
    <span class="s1">&#39;VIEW_PROCESSOR_CODE&#39;</span><span class="p">,</span>
    <span class="s1">&#39;EDIT_PROCESSOR_CONFIG&#39;</span><span class="p">,</span>
    <span class="s1">&#39;EDIT_PROCESSOR_CODE&#39;</span>

    <span class="s1">&#39;LS_PROCESSORS&#39;</span><span class="p">,</span>
    <span class="s1">&#39;LS_USERS&#39;</span><span class="p">,</span>
    <span class="s1">&#39;LS_USER&#39;</span><span class="p">,</span>
    <span class="s1">&#39;LS_PLUGS&#39;</span><span class="p">,</span>
    <span class="s1">&#39;LS_SOCKETS&#39;</span><span class="p">,</span>
    <span class="s1">&#39;LS_QUEUES&#39;</span><span class="p">,</span>
    <span class="s1">&#39;LS_AGENTS&#39;</span><span class="p">,</span>
    <span class="s1">&#39;LS_NODES&#39;</span><span class="p">,</span>
    <span class="s1">&#39;LS_SCHEDULERS&#39;</span><span class="p">,</span>
    <span class="s1">&#39;LS_WORKERS&#39;</span><span class="p">,</span>

    <span class="s1">&#39;ADD_PROCESSOR&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ADD_AGENT&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ADD_NODE&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ADD_PLUG&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ADD_PRIVILEGE&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ADD_QUEUE&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ADD_ROLE&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ADD_SCHEDULER&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ADD_SOCKET&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ADD_USER&#39;</span><span class="p">,</span>

    <span class="s1">&#39;UPDATE_PROCESSOR&#39;</span><span class="p">,</span>
    <span class="s1">&#39;UPDATE_AGENT&#39;</span><span class="p">,</span>
    <span class="s1">&#39;UPDATE_NODE&#39;</span><span class="p">,</span>
    <span class="s1">&#39;UPDATE_PLUG&#39;</span><span class="p">,</span>
    <span class="s1">&#39;UPDATE_PRIVILEGE&#39;</span><span class="p">,</span>
    <span class="s1">&#39;UPDATE_QUEUE&#39;</span><span class="p">,</span>
    <span class="s1">&#39;UPDATE_ROLE&#39;</span><span class="p">,</span>
    <span class="s1">&#39;UPDATE_SCHEDULER&#39;</span><span class="p">,</span>
    <span class="s1">&#39;UPDATE_SOCKET&#39;</span><span class="p">,</span>
    <span class="s1">&#39;UPDATE_USER&#39;</span><span class="p">,</span>

    <span class="s1">&#39;DELETE_PROCESSOR&#39;</span><span class="p">,</span>
    <span class="s1">&#39;DELETE_AGENT&#39;</span><span class="p">,</span>
    <span class="s1">&#39;DELETE_NODE&#39;</span><span class="p">,</span>
    <span class="s1">&#39;DELETE_PLUG&#39;</span><span class="p">,</span>
    <span class="s1">&#39;DELETE_PRIVILEGE&#39;</span><span class="p">,</span>
    <span class="s1">&#39;DELETE_QUEUE&#39;</span><span class="p">,</span>
    <span class="s1">&#39;DELETE_ROLE&#39;</span><span class="p">,</span>
    <span class="s1">&#39;DELETE_SCHEDULER&#39;</span><span class="p">,</span>
    <span class="s1">&#39;DELETE_SOCKET&#39;</span><span class="p">,</span>
    <span class="s1">&#39;DELETE_USER&#39;</span><span class="p">,</span>

    <span class="s1">&#39;READ_PROCESSOR&#39;</span><span class="p">,</span>
    <span class="s1">&#39;READ_AGENT&#39;</span><span class="p">,</span>
    <span class="s1">&#39;READ_NODE&#39;</span><span class="p">,</span>
    <span class="s1">&#39;READ_PLUG&#39;</span><span class="p">,</span>
    <span class="s1">&#39;READ_PRIVILEGE&#39;</span><span class="p">,</span>
    <span class="s1">&#39;READ_QUEUE&#39;</span><span class="p">,</span>
    <span class="s1">&#39;READ_ROLE&#39;</span><span class="p">,</span>
    <span class="s1">&#39;READ_SCHEDULER&#39;</span><span class="p">,</span>
    <span class="s1">&#39;READ_SOCKET&#39;</span><span class="p">,</span>
    <span class="s1">&#39;READ_USER&#39;</span>
    <span class="p">]</span>
</pre></div>
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../index.html" class="btn btn-neutral float-left" title="CLI" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../ui/index.html" class="btn btn-neutral float-right" title="UI" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022-2026, elasticcode.ai.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>